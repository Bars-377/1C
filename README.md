# Общий модуль

```1c
// Общий модуль: МодульОбмена (серверный, экспортный)

Процедура ВыгрузитьВMySQL() Экспорт       
	
	// Подключение к базе данных
	Соединение = Новый COMОбъект("ADODB.Connection");
	Соединение.ConnectionString = "Driver={MySQL ODBC 8.0 ANSI Driver};Server=172.18.11.104;Database=mdtomskbot;User=root;Password=enigma1418;";

	Попытка
	    Соединение.Open();
	    Сообщить("Соединение с базой MySQL успешно установлено.");

	    // Очистка таблицы перед вставкой новых данных
	    КомандаОчистки = Новый COMОбъект("ADODB.Command");
	    КомандаОчистки.ActiveConnection = Соединение;
	    КомандаОчистки.CommandText = "DELETE FROM base_1C";
	    КомандаОчистки.Execute();

	    Сообщить("Таблица в базе MySQL очищена.");

	Исключение
	    Сообщить("Ошибка при подключении к базе MySQL: " + ОписаниеОшибки());
	    Возврат;
	КонецПопытки;

	// Запрос к 1С-данным
	Запрос = Новый Запрос;
	Запрос.Текст = 
	    "ВЫБРАТЬ " +
	    "  Ссылка, " +
	    "  ЛицевойСчет.Код КАК КодЛицСчета " +
	    "ИЗ Документ.КассовоеВыбытие " +
	    "ГДЕ Дата IS NOT NULL " +
	    "И ЛицевойСчет.Код ПОДОБНО ""%2126000478%"" " +
	    "УПОРЯДОЧИТЬ ПО Дата";    

	Результат = Запрос.Выполнить();
	Выборка = Результат.Выбрать();

	// Создание объекта для выполнения SQL-команд
	Команда = Новый COMОбъект("ADODB.Command");
	Команда.ActiveConnection = Соединение;

	Пока Выборка.Следующий() Цикл

	    Документ = Выборка.Ссылка;

	    // Форматируем значения как строки (если нужно)
	    Дата = Строка(Документ.Дата);
	    Сумма = Строка(Документ.СуммаДокумента);
	    Договор = Строка(Документ.Договор);   
		Контрагент = Строка(Документ.Контрагент);

	    // Экранируем одинарные кавычки, если могут быть в данных
	    Дата = СтрЗаменить(Дата, "'", "''");
	    Сумма = СтрЗаменить(Сумма, "'", "''");
	    Договор = СтрЗаменить(Договор, "'", "''");  
		Контрагент = СтрЗаменить(Контрагент, "'", "''");

		// SQL-команда на вставку
	    SQL = "INSERT INTO base_1C (date, sum, agreement, counterparty) VALUES ('" + Дата + "', '" + Сумма + "', '" + Договор + "', '" + Контрагент + "')";

	    Попытка
	        Команда.CommandText = SQL;
	        Команда.Execute();
	    Исключение
	        Сообщить("Ошибка при вставке в базу MySQL: " + ОписаниеОшибки());
	    КонецПопытки;

	КонецЦикла;
	
	Сообщить("Загрузка в базу MySQL успешна.");

	// Закрываем соединение
	Соединение.Close();
	Сообщить("Соединение с базой MySQL закрыто.");

КонецПроцедуры